knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
#library(dslabs)
library(mgcv)
library(stringr)
library(dplyr)
#library(dslabs)
library(mgcv)
library(stringr)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
fit <- gam(list(ln_sdrX  ~ s(ln_saT1, k=6) + s(magnitude, k = 6) + s(Rjb, k = 6),
ln_pfaX ~ s(ln_saT1, k = 6) + s(magnitude, k = 6) + s(Rjb, k = 6)),
family = mvn(d = 2))
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
fit <- gam(list(ln_sdrX  ~ s(ln_saT1, k=6) + s(magnitude, k = 6) + s(Rjb, k = 6),
ln_pfaX ~ s(ln_saT1, k = 6) + s(magnitude, k = 6) + s(Rjb, k = 6)),
family = mvn(d = 2))
summary(fit)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX'])) ~ s(ln_saT1, k=6) s(magnitude, k=6) + s(Rjb, k=6),
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX'])) ~ s(ln_saT1, k=6) s(magnitude, k=6) + s(Rjb, k=6),
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k = 6) + s(Rjb, k = 6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k = 6) + s(Rjb, k = 6)
),
family = mvn(d = 2))
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k = 6) + s(Rjb, k = 6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k = 6) + s(Rjb, k = 6)
),
family = mvn(d = 2))
summary(fit)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX'])) ~ s(ln_saT1, k=6) s(magnitude, k=6) + s(Rjb, k=6),
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 4))
summary(fit)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 8))
summary(fit)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 12))
summary(fit)
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(ln_saT1, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(ln_saT1, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
fit$df.residual
#
# estimated cov matrix between SDR and PFA
cov <- solve(crossprod(fit$family$data$R))
cov
# correlation matrix between SDR and PFA
cov2cor(cov)
fit$df.residual
plot(fit)
lnIM = lnPGA
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
View(fit)
View(dat)
library(dplyr)
#library(dslabs)
library(mgcv)
library(stringr)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
lnCAV = log(as.matrix(dat['CAV']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
lnIM = ln_saT1
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = lnPGA
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = lnPGV
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = ln_saAvg
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = lnCAV
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
library(dplyr)
#library(dslabs)
library(mgcv)
library(stringr)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
lnCAV = log(as.matrix(dat['CAV']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
lnIM = lnPGA
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
#dat = read.csv('Inputs_for_s4_96x48_veryhigh_pID1.csv', header = TRUE)
dat = read.csv('Inputs_for_s4_96x48_veryhigh_avg_EDP.csv', header = TRUE)
magnitude = read.table('data/Magnitude.txt', header=FALSE)
Rjb = read.table('data/Distance_Rjb.txt', header = FALSE)
columns = colnames(dat)
head(dat)
ln_sdrX = as.matrix(log(dat['story_1_sdrX']))
ln_pfaX = as.matrix(log(dat['story_1_pfaX']))
ln_saT1 = as.matrix(log(dat['SaT1']))
lnPGA = log(as.matrix(dat['PGA']))
lnPGV = log(as.matrix(dat['PGV']))
ln_saAvg = log(as.matrix(dat['Sa_avg']))
lnCAV = log(as.matrix(dat['CAV']))
magnitude = as.matrix(magnitude)
Rjb = as.matrix(log(Rjb))
#df <- data.frame(SDR=ln_sdrX, PFA=ln_pfaX, SaT1=ln_saT1, SaAvg=ln_saAvg, magnitude=magnitude,
#                 distance = Rjb, PGV=lnPGV, PGA = lnPGA)
#df
lnIM = lnPGA
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = ln_saT1
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = lnPGV
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = ln_saAvg
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
lnIM = lnCAV
fit <- gam(list(as.matrix(log(dat['story_1_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_1_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_1_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_2_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_2_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_3_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_3_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrX']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaX'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6),
as.matrix(log(dat['story_4_sdrZ']))  ~ s(lnIM, k=6) + s(magnitude, k=6) + s(Rjb, k=6),
as.matrix(log(dat['story_4_pfaZ'])) ~ s(lnIM, k = 6) + s(magnitude, k=6) + s(Rjb,k=6)
),
family = mvn(d = 16))
summary(fit)
